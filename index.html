<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Opening...</title>
    <script>
        // 【最速処理】 DOM読み込みを待たずに即実行
        (function() {
            const params = new URLSearchParams(window.location.search);
            const path = params.get('path');
            if(path) {
                // 許可済みなら、ここで一瞬でエクスプローラーが開き、ユーザーはブラウザの存在に気づかないレベルになる
                window.location.href = "wpb:" + decodeURIComponent(path);
            }
        })();
    </script>
    <style>
        /* 画面は一瞬しか表示されない前提なのでシンプルに */
        body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background: #fff; }
        .msg { color: #888; font-size: 0.8rem; }
    </style>
</head>
<body>
    <div class="msg">起動中...</div>
    <script>
        // 処理が終わったら即閉じを試みる
        // (許可済み設定ならポップアップが出ないので、フォーカス制御等は不要でシンプルに閉じる)
        setTimeout(() => {
            // 閉じるのを試みる
            window.close();
            
            // もし閉じられなかった場合（セキュリティ制限）、完了表示にする
            document.body.innerHTML = "<div style='text-align:center;'>✅ 完了<br><span style='font-size:10px; color:#ccc'>タブを閉じてください</span></div>";
        }, 500); // 0.5秒だけ待って閉じる
    </script>
</body>
</html>