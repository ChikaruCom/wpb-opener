<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Opening...</title>
    <script>
        // ã€é«˜é€ŸåŒ–1ã€‘ DOMæç”»ã‚’å¾…ãŸãšã«ã€ãƒ˜ãƒƒãƒ‰å†…ã§å³æ™‚å®Ÿè¡Œ
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const path = urlParams.get('path');
            
            if (path) {
                const decodedPath = decodeURIComponent(path);
                
                // ã€é«˜é€ŸåŒ–2ã€‘ .href ã§ã¯ãªã .replace ã‚’ä½¿ç”¨
                // å±¥æ­´ã«æ®‹ã•ãªã„ã“ã¨ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®å‡¦ç†ã‚’ã‚ãšã‹ã«è»½ãã—ã€
                // ã€Œæˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã®æŒ™å‹•ã‚‚è‡ªç„¶ã«ã—ã¾ã™ã€‚
                window.location.replace("wpb:" + decodedPath);

                // UIè¡¨ç¤ºç”¨ã®ãƒ‘ã‚¹ã‚’ä¿å­˜ï¼ˆå¾Œã§bodyãŒè¡¨ç¤ºã•ã‚ŒãŸæ™‚ã«ä½¿ã†ï¼‰
                window.targetPath = decodedPath; 
            }
        })();
    </script>
    <style>
        /* ã‚¹ã‚¿ã‚¤ãƒ«ã¯å¿…è¦æœ€å°é™ã« */
        body { font-family: sans-serif; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; margin: 0; background: #f4f7f9; opacity: 0; transition: opacity 0.5s; }
        .card { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; }
        .path { color: #555; font-size: 0.9rem; word-break: break-all; margin-top: 10px; }
        /* ã€é«˜é€ŸåŒ–3ã€‘ æœ€åˆã¯é€æ˜ã«ã—ã¦ãŠãã€ãƒãƒ©ã¤ãã‚’é˜²æ­¢ï¼ˆå‡¦ç†ãŒé€Ÿã‘ã‚Œã°ç”»é¢ã¯è¦‹ãˆãªã„ã¾ã¾çµ‚ã‚ã‚‹ï¼‰ */
        body.visible { opacity: 1; }
    </style>
</head>
<body>
    <div class="card">
        <h3>ğŸš€ é–‹ã„ã¦ã„ã¾ã™...</h3>
        <p>ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€Œé–‹ãã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
        <div id="pathDisplay" class="path"></div>
    </div>

    <script>
        // ã“ã“ã¯UIåˆ¶å¾¡ã¨ã‚¯ãƒ­ãƒ¼ã‚ºå‡¦ç†ã®ã¿
        if (window.targetPath) {
            document.getElementById('pathDisplay').innerText = window.targetPath;
            
            // 0.5ç§’çµŒã£ã¦ã‚‚ã¾ã ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ã„ã¦ã„ãŸã‚‰ã€UIã‚’ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã•ã›ã‚‹
            // (ä¸€ç¬ã§é–‹ã„ãŸå ´åˆã¯ã€ç™½ã„ç”»é¢ã‚’è¦‹ã›ãšã«é–‰ã˜ã‚‹ãŸã‚)
            setTimeout(() => {
                document.body.classList.add('visible');
            }, 500);

            // ã‚¯ãƒ­ãƒ¼ã‚ºå‡¦ç†ï¼ˆå¤‰æ›´ãªã—ã€ã“ã‚ŒãŒæœ€é©è§£ã§ã™ï¼‰
            window.onfocus = function() {
                setTimeout(() => { window.close(); }, 200); 
            };
            // å®‰å…¨ç­–ã®è‡ªå‹•ã‚¯ãƒ­ãƒ¼ã‚ºï¼ˆæ™‚é–“ã‚’çŸ­ç¸®ï¼š10ç§’â†’3ç§’ï¼‰
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã«å¯¾å¿œã™ã‚‹ã®ã«3ç§’ã‚ã‚Œã°ååˆ†ã¨åˆ¤æ–­
            setTimeout(() => { window.close(); }, 3000);

        } else {
            document.body.innerHTML = "<h3>ãƒ‘ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</h3>";
            document.body.classList.add('visible');
        }
    </script>
</body>
</html>
